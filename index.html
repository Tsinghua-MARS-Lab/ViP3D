<!DOCTYPE HTML>
<!--
	Story by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)

	Note: Only needed for demo purposes. Delete for production sites.
-->
<html>
<head>
    <title>ViP3D</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
    <link rel="stylesheet" href="assets/css/main.css"/>
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css"/>
    </noscript>
</head>
<body class="is-preload">

<!-- Wrapper -->
<section id="wrapper" class="divided">

    <!-- One -->
    <section
            class="banner style1 orient-left content-align-center image-position-center fullscreen onload-image-fade-in onload-content-fade-right">
        <div class="content">
            <div style="align-items: center; display: flex; flex-direction: row; width: 1200px; justify-content: flex-start; margin-left: -200px; margin-top: -100px">
                <div class="image" style="width: 200px; height: 250px; background-color: white">
                    <img src="images/logo.png" alt=""/>
                </div>
                <h2 style="">ViP3D: End-to-end Visual Trajectory Prediction <br> via 3D Agent Queries</h2>
            </div>
            <p><a>Junru Gu</a><sup>1</sup>*,
                <a>Chenxu Hu</a><sup>1</sup>*,
                <a>Tianyuan Zhang</a><sup>2,3</sup>,
                <a>Xuanyao Chen</a><sup>2,4</sup>,
                <br/>
                <a>Yilun Wang</a><sup>5</sup>,
                <a>Yue Wang</a><sup>6</sup>,
                <a>Hang Zhao</a><sup>1,2</sup>
            <h6><small>* Equal contribution</small></h6>
            <h5>
                <sup>1</sup> IIIS, Tsinghua University,
                <sup>2</sup> Shanghai Qi Zhi Institute,
                <br/>
                <sup>3</sup> CMU,
                <sup>4</sup> Fudan University,
                <sup>5</sup> Li Auto,
                <sup>6</sup> MIT
            </h5>
            <!-- <p>* Denotes equal contribution</p> -->
            <!--            <h3>CVPR 2022</h3>-->
            <p>ViP3D is the first vision-based approach to predict future trajectories of agents for autonomous
                driving, modeling instance-wise agent detection, tracking and prediction.</p>
            <!-- <p class="major">A (modular, highly tweakable) responsive one-page template designed by <a href="https://html5up.net">HTML5 UP</a> and released for free under the <a href="https://html5up.net/license">Creative Commons</a>.</p> -->
            <div class="inner">
                <ul class="icons">
                    <!--                    <li><a href="https://github.com/Tsinghua-MARS-Lab/M2I" class="icon brands style2 fa-github"><span-->
                    <!--                            class="label">Github</span></a>-->
                    <!--                    </li>-->
                    <li><a href="https://arxiv.org/abs/2208.01582" target="_blank" class="icon style2 fa-file-pdf"><span
                            class="label">Arxiv</span></a>
                    </li>
                </ul>
            </div>

            <ul class="actions stacked">
                <li><a href="#first" class="button big wide smooth-scroll-middle">Learn More</a></li>
            </ul>
        </div>
        <!--        <div class="image" style="width: 600px; ">-->
        <!--            <img src="images/teaser.png" alt=""/>-->
        <!--        </div>-->
    </section>

    <section>
        <span class="video">
        <video controls autoplay muted loop class="html-video" width=100% height=auto>
            <source src="videos/demo.mp4" type="video/mp4">
            </video>
        </span>
    </section>

    <!-- Abstract -->
    <section class="wrapper style1 align-left" id="first">
        <div class="inner">
            <h2>Abstract</h2>
            <p>Existing autonomous driving pipelines separate the perception module from the prediction module. The two
                modules communicate via hand-picked features such as agent boxes and trajectories as interfaces. Due to
                this separation, the prediction module only receives partial information from the perception module.
                Even worse, errors from the perception modules can propagate and accumulate, adversely affecting the
                prediction results. In this work, we propose ViP3D, a visual trajectory prediction pipeline that
                leverages the rich information from raw videos to predict future trajectories of agents in a scene.
                ViP3D employs sparse agent queries throughout the pipeline, making it fully differentiable and
                interpretable. Furthermore, we propose an evaluation metric for this novel end-to-end visual trajectory
                prediction task. Extensive experimental results on the nuScenes dataset show the strong performance of
                ViP3D over traditional pipelines and previous end-to-end models.
            </p>
        </div>
    </section>

    <!-- Method -->
    <section class="wrapper style1 align-left">
        <div class="inner">
            <h2>Pipelines</h2>
            <p>The traditional pipeline involves multiple non-differentiable modules, e.g., detection, tracking, and
                prediction. ViP3D takes multi-view videos as input and generates predicted trajectories in an end-to-end
                manner, which can effectively leverage visual information such as turning signals of vehicles.
            </p>
            <span class="image main"><img src="images/motivation.png" alt=""/></span>
        </div>
    </section>


    <!-- Relation prediction demos -->
    <!--    <section class="wrapper style1 align-left">-->
    <!--        <div class="inner">-->
    <!--            <h2>Relationship Prediction Demos</h2>-->
    <!--            <p>Here are some of our relationship prediction results against some very challenging scenarios from the <a-->
    <!--                    href="https://waymo.com/open/">Waymo Open Motion Dataset</a>. Our relation predictor can successfuly-->
    <!--                predict relations involving interactive vehicles marked in blue. Detected relationships were marked as-->
    <!--                red arrows from the influencers to the reactors.</p>-->
    <!--            &lt;!&ndash; <img class="image main" width=45% height=auto src="images/legends1.png" alt="" /> &ndash;&gt;-->
    <!--            <img width=100% height=auto src="images/legends1.png" alt=""/>-->
    <!--        </div>-->
    <!--        <div class="items style1 medium onscroll-fade-in">-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/merging_normal_3.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Merging into high speed traffic</h3>-->
    <!--                <p>The relationship predictor chooses the best influencer to follow while merging.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/normal_merging_16.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Merging into crowded traffic</h3>-->
    <!--                <p>The relationship predictor correctly sorts the crowd before the green light at an intersection.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/crazy_merging.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Multiple lane changings</h3>-->
    <!--                <p>The relationship predictor selects reasonable influencers for both blue agents against complex-->
    <!--                    scenarios.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/yielding_1.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding to a jaywalker</h3>-->
    <!--                <p>The relationship predictor learns to yield to pedestrians when nessesary.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/yielding_2.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding to other vehicles</h3>-->
    <!--                <p>The relationship predictor learns the right of the way.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/yielding_3.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding with detection failure</h3>-->
    <!--                <p>The relationship predictor can make correct predictions with detection failures on the traffic-->
    <!--                    lights.</p>-->
    <!--            </section>-->
    <!--        </div>-->
    <!--    </section>-->

    <!-- Relation prediction demos -->
    <!--    <section class="wrapper style1 align-left">-->
    <!--        <div class="inner">-->
    <!--            <h2>Conditional Trajectory Prediction Demos</h2>-->
    <!--            <p>Here are some of our conditional trajectory prediction results for the reactors from the <a-->
    <!--                    href="https://waymo.com/open/">Waymo Open Motion Dataset</a>. Our conditional trajectory predictor-->
    <!--                outperforms the marginal trajectory predictor on solving conflicts under complex multi-agent-->
    <!--                interactions.</p>-->
    <!--            <img width=100% height=auto src="images/legends1.png" alt=""/>-->
    <!--        </div>-->
    <!--        <div class="items style1 medium onscroll-fade-in">-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_yield_p.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding to pedestrians</h3>-->
    <!--                <p>The conditional predictor predicts a yielding trajectory after several pedestrians in a busy-->
    <!--                    intersection.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_yielding_p.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding to a cyclist</h3>-->
    <!--                <p>The conditional predictor predicts a yielding trajectory after a cyclist in a busy intersection.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_yielding_p2.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Yielding to a jaywalker</h3>-->
    <!--                <p>The conditional predictor predicts a yielding trajectory after a jaywalker. A clear <strong>slow-->
    <!--                    down</strong> and <strong>speed up</strong> can be spotted before and after the interaction.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_merge_2.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Turning into the main road</h3>-->
    <!--                <p>The conditional trajectory predictor predicts the turning vehicle to wait until it is clear of-->
    <!--                    traffic.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_turning_1.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Right turns yield to continous left turns</h3>-->
    <!--                <p>The conditional trajectory predictor predicts a turning trajectory until previous traffic is-->
    <!--                    clear.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_merging.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Cutting in before an intersection</h3>-->
    <!--                <p>The conditional predictor generates shorter and slower trajectory for the reactor than the-->
    <!--                    influencer.</p>-->
    <!--            </section>-->
    <!--            <section>-->
    <!--							<span class="video">-->
    <!--								<video controls autoplay muted loop class="html-video" width=100% height=auto>-->
    <!--									<source src="videos/traj_following_turning.mp4" type="video/mp4">-->
    <!--									</video>-->
    <!--								</span>-->
    <!--                <h3>Following another vehicle</h3>-->
    <!--                <p>The conditional predictor generates trajectories for the vehicle to follow the leading vehicle when-->
    <!--                    turning right.</p>-->
    <!--            </section>-->
    <!--        </div>-->
    <!--    </section>-->

    <section class="wrapper style1 align-left">
        <div class="inner">
            <h2>Related Projects</h2>
            <div class="col text-center">
                <table width="100%" style="margin: 0pt 0pt; text-align: center;">
                    <tbody>
                    <tr>
                        <td>
                            BEV Vectorized Mapping<br>
                            <a href="https://tsinghua-mars-lab.github.io/vectormapnet/" class="d-inline-block p-3"><img
                                    height="100" src="images/VectorMapNet_thumbnail.png" style="border:1px solid"
                                    data-nothumb=""><br>VectorMapNet</a>
                        </td>

                        <td>
                            BEV Detection<br>
                            <a href="https://tsinghua-mars-lab.github.io/detr3d/" class="d-inline-block p-3"><img
                                    height="100" src="images/detr3d_thumbnail.png" style="border:1px solid"
                                    data-nothumb=""><br>DETR3D</a>
                        </td>

                        <td>
                            BEV Fusion<br>
                            <a href="https://tsinghua-mars-lab.github.io/futr3d/" class="d-inline-block p-3"><img
                                    height="100" src="images/futr3d_thumbnail.png" style="border:1px solid"
                                    data-nothumb=""><br>FUTR3D</a>
                        </td>

                        <td>
                            BEV Tracking<br>
                            <a href="https://tsinghua-mars-lab.github.io/mutr3d/" class="d-inline-block p-3"><img
                                    height="100" src="images/mutr3d_thumbnail.png" style="border:1px solid"
                                    data-nothumb=""><br>MUTR3D</a>
                        </td>

                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!--    <section class="wrapper style1 align-left">-->
    <!--        <div class="title" id="lang">Related Projects on <a href="https://vcad-ai.github.io/">VCAD (Vision-Centric-->
    <!--            Autonomous Driving)</a></div>-->
    <!--    </section>-->

    <section class="wrapper style1 align-left">
        <div class="inner">
            <h2>Citing</h2>
            <p>If you find our work intriguing, inspiring or useful to your research, please consider citing:</p>
            <blockquote style="text-align:left; background-color:#EEEEEE">
                @article{vip3d,<br>
                title={ViP3D: End-to-end Visual Trajectory Prediction via 3D Agent Queries},<br>
                author={Gu, Junru and Hu, Chenxu and Zhang, Tianyuan and Chen, Xuanyao and Wang, Yilun and Wang, Yue and
                Zhao, Hang},<br>
                journal={arXiv preprint arXiv:2208.01582},<br>
                year={2022}<br>
                }
            </blockquote>
        </div>
    </section>

    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.scrollex.min.js"></script>
    <script src="assets/js/jquery.scrolly.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>

</body>
<script type="module">
  import init from './target/wasm_example.js'

  init()
</script>
</html>
